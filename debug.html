<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯•é¡µé¢</title>
    <script>
        // Configure base path for the application
        window.APP_CONFIG = {
            basePath: '/literate-fortnight'
        };
    </script>
    <base href="/literate-fortnight/">
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .test {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #4A90E2;
        }
        .error {
            border-left-color: #dc3545;
            background: #fff5f5;
        }
        .success {
            border-left-color: #28a745;
            background: #f5fff5;
        }
        h1 { color: #333; }
        h2 { color: #666; font-size: 18px; }
        pre { 
            background: #f8f8f8; 
            padding: 10px; 
            overflow-x: auto;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” åº”ç”¨è¯Šæ–­é¡µé¢</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function addTest(title, status, details) {
            const div = document.createElement('div');
            div.className = `test ${status}`;
            div.innerHTML = `
                <h2>${status === 'success' ? 'âœ…' : 'âŒ'} ${title}</h2>
                <pre>${details}</pre>
            `;
            results.appendChild(div);
        }

        // Test 1: åŸºç¡€è·¯å¾„
        addTest('å½“å‰URL', 'success', `
URL: ${window.location.href}
Pathname: ${window.location.pathname}
Base: ${document.baseURI}
        `);

        // Test 2: APP_CONFIG
        addTest('APP_CONFIG', window.APP_CONFIG ? 'success' : 'error', 
            window.APP_CONFIG ? JSON.stringify(window.APP_CONFIG, null, 2) : 'æœªå®šä¹‰'
        );

        // Test 3: CSSåŠ è½½
        const cssLoaded = document.styleSheets.length > 1;
        addTest('CSSåŠ è½½', cssLoaded ? 'success' : 'error', 
            `å·²åŠ è½½ ${document.styleSheets.length} ä¸ªæ ·å¼è¡¨`
        );

        // Test 4: æµ‹è¯•æ¨¡å—åŠ è½½
        addTest('æµ‹è¯•æ¨¡å—åŠ è½½', 'success', 'æ­£åœ¨æµ‹è¯•...');
        
        import('./js/config/ConfigManager.js')
            .then(module => {
                addTest('ConfigManageræ¨¡å—', 'success', 'âœ… æ¨¡å—åŠ è½½æˆåŠŸ');
                const config = new module.ConfigManager();
                addTest('ConfigManagerå®ä¾‹åŒ–', 'success', JSON.stringify({
                    deviceName: config.getDeviceName(),
                    brokerType: config.getBrokerType(),
                    channelName: config.getChannelName()
                }, null, 2));
            })
            .catch(error => {
                addTest('ConfigManageræ¨¡å—', 'error', `
é”™è¯¯: ${error.message}
å †æ ˆ: ${error.stack}
                `);
            });

        // Test 5: æ£€æŸ¥DOMå…ƒç´ 
        setTimeout(() => {
            const app = document.getElementById('app');
            addTest('DOMå…ƒç´ æ£€æŸ¥', 'success', `
#app å­˜åœ¨: ${!!app}
body å­å…ƒç´ æ•°: ${document.body.children.length}
            `);
        }, 100);

        // Test 6: å¤–éƒ¨SDK
        setTimeout(() => {
            addTest('Pusher SDK', typeof Pusher !== 'undefined' ? 'success' : 'error',
                typeof Pusher !== 'undefined' ? 'âœ… Pusherå·²åŠ è½½' : 'âŒ PusheræœªåŠ è½½'
            );
            addTest('Ably SDK', typeof Ably !== 'undefined' ? 'success' : 'error',
                typeof Ably !== 'undefined' ? 'âœ… Ablyå·²åŠ è½½' : 'âŒ AblyæœªåŠ è½½'
            );
        }, 2000);
    </script>
</body>
</html>
